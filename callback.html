<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Discord 認証結果</title>
    <script>
        // URLのクエリパラメータから認証コードを取得
        function getQueryParam(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        window.onload = async function() {
            const code = getQueryParam('code');
            if (code) {
                document.getElementById('auth-code').innerText = '認証コード: ' + code;

                // Glitchサーバーに認証コードを送信し、ユーザー情報を取得
                try {
                    const response = await fetch(`https://your-glitch-project-name.glitch.me/callback?code=${code}`);
                    const userData = await response.json();
                    
                    // ユーザー情報を表示
                    document.getElementById('username').innerText = `ユーザー名: ${userData.username}#${userData.discriminator}`;
                    
                    // アバターのURLを作成して表示
                    const avatarUrl = `https://cdn.discordapp.com/avatars/${userData.id}/${userData.avatar}.png`;
                    document.getElementById('avatar').src = avatarUrl;
                } catch (error) {
                    console.error(error);
                    document.getElementById('error').innerText = 'ユーザー情報の取得に失敗しました。';
                }
            } else {
                document.getElementById('auth-code').innerText = '認証コードがありません。';
            }
        };
    </script>
</head>
<body>
    <h1>Discord 認証結果</h1>
    <p id="auth-code">認証コードを取得中...</p>
    <div id="user-info">
        <p id="username"></p>
        <img id="avatar" alt="ユーザーアバター" />
    </div>
    <p id="error" style="color: red;"></p>
</body>
</html>
